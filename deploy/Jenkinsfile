pipeline {
    agent any

    environment {
        private_registry = "harbor.kcnet.bigdata.com:30443/bigdata"
        image_name = "bigdata_miniproject_api"
        reg_cred = "harbor_cred"
    }

    stages {
        // docker build
        stage('Bulid & Push Docker') {
            docker.withRegistry(private_registry, reg_cred) {
                def docker_image = docker.build("${image_name}:latest", "--no-cache deploy/docker")
                echo "docker build completed!!!"
                docker_image.push()
        }
    }
}